let $choose=$("#chooseImage"),$modal=$("#modal"),$modalBody=$modal.find(".modal-body"),$preloader=$modal.find(".preloader"),$alert=$modal.find(".alert"),$input=$('[name="product[image_id]"]'),url=window.location.protocol+"//"+window.location.host+"/api/image";$modal.on("show.bs.modal",async function(a){$preloader.show(),$alert.hide(),$modalBody.find(" > :not(.preloader)").remove();let o=await fetch(url);if((o=await o.json()).error)$alert.text("Что то пошло не так. Попробуйте перезагрузить страницу"),$alert.show(),$preloader.hide();else{let a=$('<div class="images"/>');$.each(o.data,(o,e)=>{let t=$('<div class="image"/>'),d=$("<img/>"),r=$("<span />");t.click(()=>{$input.val(e.id),$(".image-name").text(e.alias),$modal.modal("hide")}),d.attr("src",e.path),r.text(e.alias),d.appendTo(t),r.appendTo(t),t.appendTo(a)}),$preloader.hide(),a.appendTo($modalBody)}});let $params=$("form .form-group.param"),$addButton=$params.find("span.btn.add"),$deleteButton=$params.find("span.btn.remove");$deleteButton.click(function(){let a=$(this);if($("form .form-group.param").length>1){a.closest(".form-group.param").remove()}}),$addButton.click(function(){$(this);let a=$("form .form-group.param").last(),o=a.attr("data-id"),e=a.clone(!0);id=+o+1,e.attr("data-id",id),e.find("select").attr("name",`product[param][${id}][id]`),e.find('input[type="text"]').attr("name",`product[param][${id}][value]`),a.after(e)});